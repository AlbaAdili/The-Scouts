@{
    ViewData["Title"] = "Home";
}

<div class="d-flex flex-column align-items-center py-5">
    <h1 class="display-5 text-center">
        Explore our innovative approach, emphasizing scouting and connecting with the best talents.
    </h1>
    <a href="@Url.Action("Index","About")" class="learn-more">Learn more &rsaquo;</a>
    <img src="~/images/recruitment-illustration.jpeg" alt="Recruitment Illustration" class="recruitment-illustration mt-5" />
</div>

<div class="d-flex flex-column align-items-center">
    <table class="table jobs-table text-white" id="jobs-table">
        <thead>
            <tr>
                <th class="text-start">Location</th>
                <th class="text-middle">Job Title</th>
                <th class="text-end">Job Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td colspan="3" class="text-center">Loading jobs...</td>
            </tr>
        </tbody>
    </table>
</div>

<div class="d-flex justify-content-between align-items-center">
    <img src="~/images/job-hunting.jpeg" alt="Job Hunting Illustration" class="mt-3" style="width: 50%;" />
    <p>
        Scout is a soldier or other person sent out ahead of a main force to gather information about the enemy's position, strength, or movements.
        <strong>"The Scouts"</strong> represents a group of individuals working together to scout and identify qualified, and good-fit candidates for the best-match job position.
    </p>
</div>

<script>
    document.addEventListener("DOMContentLoaded", async () => {
        const token = localStorage.getItem("token");
        const res = await fetch("/api/job", {
            headers: {
                "Authorization": `Bearer ${token}`
            }
        });

        const jobs = await res.json();
        const tableBody = document.querySelector("#jobs-table tbody");
        tableBody.innerHTML = "";

        if (res.ok && jobs.length > 0) {
            jobs.slice(0, 5).forEach(job => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td class="text-start">${job.city}, ${job.country}</td>
                    <td class="text-middle">${job.title}</td>
                    <td class="text-end">
                        <a href="/Jobs/Details/${job.id}" class="link-primary">Read More &#x2198;</a>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            const finalRow = document.createElement("tr");
            finalRow.innerHTML = `
                <td class="text-end" colspan="3">
                    <a href="/Jobs" class="link-primary">Show All Open Positions &#x2198;</a>
                </td>
            `;
            tableBody.appendChild(finalRow);
        } else {
            tableBody.innerHTML = `<tr><td colspan="3" class="text-center">No jobs found.</td></tr>`;
        }
    });
</script>
