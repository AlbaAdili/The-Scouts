@{
    ViewData["Title"] = "Register";
}

<form id="registerForm" class="position-form">
    <h2 class="display-6">Register</h2>

    <div class="form-content">
        <label for="Email" class="control-label">Email</label>
        <input id="Email" name="Email" class="form-control" placeholder="name@example.com" required />
    </div>

    <div class="form-content">
        <label for="Password" class="control-label">Password</label>
        <input id="Password" type="password" name="Password" class="form-control" placeholder="Enter Password" required />
    </div>

    <div class="form-content">
        <label for="ConfirmPassword" class="control-label">Confirm Password</label>
        <input id="ConfirmPassword" type="password" name="ConfirmPassword" class="form-control" placeholder="Confirm Password" required />
    </div>

    <button type="submit" class="btn button-primary">Register</button>

    <div class="form-content">
        <p>Already have an account? <a href="/Account/Login" style="text-decoration: none;">Login</a></p>
    </div>
</form>

<script>
    document.getElementById("registerForm").addEventListener("submit", async function (e) {
        e.preventDefault();

        const email = document.getElementById("Email").value;
        const password = document.getElementById("Password").value;
        const confirmPassword = document.getElementById("ConfirmPassword").value;

        if (password !== confirmPassword) {
            alert("Passwords do not match");
            return;
        }

        const response = await fetch("/api/auth/register", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password })
        });

        const result = await response.text();

        if (response.ok) {
            alert("Registration successful. Please log in.");
            window.location.href = "/Account/Login";
        } else {
            alert(result || "Registration failed");
        }
    });
</script>
